# Điều kiện cơ bản

Tính đến thời điểm hiện tại thì ngoại trừ [Nobihaza 2 Remake bản Tiếng Việt](https://nobi2.s1432.org) ra, thì **không có game nào khác** có thể chạy trực tiếp trên macOS mà không cần phải qua các bước rườm rà cả.

* Bạn **bắt buộc** phải làm hết tất cả các bước trong hướng dẫn này để đảm bảo quá trình chơi game sẽ ít trục trặc nhất có thể.

* Tuy nhiên, bạn cũng có thể cài đặt máy ảo chạy Windows, hoặc dùng BootCamp để cài Windows lên máy Mac của bạn; và sau đó [áp dụng các hướng dẫn dành cho Windows](../1.%20Windows). Tuy nhiên việc này vượt quá phạm vi hướng dẫn về Nobihaza của mình nên mình sẽ không hướng dẫn ở đây.<br>Hướng dẫn này chỉ dành cho những người muốn chạy game **trực tiếp** trên macOS thông qua các công cụ hỗ trợ.

* **Không phải game Windows nào cũng sẽ có thể chạy được trên macOS**. Nếu bạn gặp lỗi khi chạy game thì không còn cách nào khác, bạn bắt buộc phải liên hệ với nhà phát triển để yêu cầu một bản chính thức cho macOS.

* Các cách này có thể không hoạt động đối với những máy Mac chạy CPU **Apple silicon** (M1 trở lên). Mình thì không có máy Mac dạng này nên mình không thể hướng dẫn chi tiết được.

## Cấu hình máy tính

Trước khi làm theo hướng dẫn này, hãy đảm bảo thiết bị của bạn đang ở **macOS 10.15** (Catalina) trở lên. Điều đó đồng nghĩa với việc máy Mac của bạn phải là một trong những máy sau:

* iMac đời 2012 hoặc cao hơn
* iMac Pro đời 2017
* MacBook đời 2015 hoặc cao hơn
* MacBook Air đời 2012 hoặc cao hơn
* MacBook Pro đời 2012 hoặc cao hơn
* Mac Mini đời 2012 hoặc cao hơn
* Mac Pro đời 2013 hoặc cao hơn

Máy bạn cũng cần có ít nhất 4GB RAM trở lên.

## Cài đặt ban đầu

### Vô hiệu hoá Gatekeeper

**Gatekeeper** là một tính năng của macOS giúp ngăn chặn các ứng dụng bên thứ ba mà không được xác minh bởi Apple (nói đúng hơn là chưa mua chứng chỉ giá 99$/năm của Apple). Tuy nhiên có một số game và công cụ hỗ trợ sẽ không thể chạy được nếu không tắt Gatekeeper đi.

Điều này cũng làm giảm độ bảo mật của macOS, nhưng không còn cách nào khác.

* Mở ứng dụng **Terminal** và nhập dòng lệnh sau:

```sh
sudo spctl --master-disable
```

* Nhập mật khẩu macOS của bạn nếu như được yêu cầu và nhấn Enter.

![1](image.png)

* Bạn có thể vào phần **System Preferences** -> **Security & Privacy** -> **General**, nếu như trong mục **Allow apps downloaded from** có thêm mục **Anywhere** thì tức là bạn đã tắt Gatekeeper thành công.

### The Unarchiver

Mặc dù trình giải nén mặc định của macOS thông minh hơn rất nhiều so với bên Windows, nhưng nó vẫn không thể giải nén được một số định dạng tệp tin nén, nên bạn vẫn nên tải phần mềm giải nén từ bên ngoài.

* [Tải xuống The Unarchiver](https://dl.devmate.com/com.macpaw.site.theunarchiver/TheUnarchiver.dmg), sau đó mở tệp tin `TheUnarchiver.dmg` đã tải xuống.

* Kéo mục `The Unarchiver.app` vào thư mục `Applications` của macOS.

![4](image-3.png)

* Mở ứng dụng **The Unarchiver** bằng Launchpad hoặc ở thư mục `Applications`.

![5](image-4.png)

* Nhấn vào nút **Select All** trong cửa sổ của The Unarchiver và tắt cửa sổ đi.

![6](image-5.png)

* Giờ đây, The Unarchiver sẽ thay thế trình giải nén mặc định của macOS để giải nén các tệp tin.

### Xcode Command Line Tools

Công cụ này sẽ cài các thư viện cần thiết để cài MacPorts bên dưới và các công cụ hỗ trợ khác.

* Mở **Terminal** của macOS lên và nhập dòng lệnh sau:

```sh
xcode-select --install
```

* Một hộp thoại sẽ hiện lên, nhấn **Install** để tiếp tục. Bạn có thể sẽ được yêu cầu nhập mật khẩu macOS của máy.

![2](image-1.png)

* Nhấn vào nút **Agree** để đồng ý Điều khoản sử dụng của Xcode. Sau đó hãy đợi cho quá trình cài đặt hoàn tất như ảnh bên dưới.

![8](image-7.png)

### MacPorts

**MacPorts** sẽ cần thiết để cài đặt các công cụ hỗ trợ chơi game trên macOS.

* Truy cập vào [trang web chính thức của MacPorts](https://www.macports.org/install.php).

* Chọn phiên bản macOS bạn đang sử dụng ở danh sách. Nếu bạn đang sử dụng phiên bản cũ hơn, hãy nhấn vào **Older OS**.

![3](image-2.png)

* Chạy tệp tin `.pkg` đã tải xuống. Một cửa sổ cài đặt sẽ xuất hiện, hãy nhấn **Continue** liên tục và sau đó nhấn **Install** để bắt đầu cài đặt. Nhập mật khẩu macOS và đợi cho quá trình cài đặt hoàn tất.

![7](image-6.png)

### FluidSynth

Bạn sẽ cần thêm cả công cụ này để game có thể phát nhạc dưới dạng MIDI (đa số các game RPG Maker 2000/2003 và XP/VX/VX Ace đều sẽ dùng nhạc định dạng này!). Bạn có thể bỏ qua nếu như không cần nghe nhạc, hoặc chỉ chơi game dựa trên RPG Maker MV/MZ.

* Mở ứng dụng **Terminal** lên và nhập dòng lệnh sau, sau đó nhấn Enter và nhập mật khẩu macOS của bạn.

```sh
sudo port install fluidsynth
```

* Nhập `Y` và nhấn `Enter` khi cửa sổ Terminal hiện ra chữ Continue.

![9](image-8.png)

* Quá trình cài đặt sẽ mất khá nhiều thời gian nên bạn hãy cố gắng chờ đợi, cho đến khi hiện dòng chữ `No broken files found` như ảnh dưới.

![10](image-9.png)

* Bạn cần tải thêm cả [soundfont được sử dụng trên Windows](https://musical-artifacts.com/artifacts/713/gm.sf2) để có trải nghiệm nghe giống với Windows nhất. Lưu ý đường dẫn của tệp này sau khi tải xuống, và bạn sẽ cần sử dụng nó về sau này.

## Wine và Kegworks

*(Nếu bạn không có ý định chạy bất kì game nào được làm bằng RPG Maker VX Ace trở xuống trên macOS, bạn có thể bỏ qua bước này.)*

**Wine** (viết tắt của **Wine Is Not Emulator**) là một lớp tương thích để chạy ứng dụng Windows trên các hệ điều hành khác, còn **Kegworks** là ứng dụng để hỗ trợ chạy Wine được dễ dàng hơn trên macOS.

### Cài đặt Kegworks

* Mở ứng dụng **Terminal** và nhập dòng lệnh sau, sau đó nhấn Enter và nhập mật khẩu macOS của bạn.

```sh
sudo port install kegworks
```

* Đợi cho quá trình cài đặt hoàn tất như ảnh bên dưới.

![11](image-10.png)

* Bạn sẽ thấy ứng dụng **Kegworks Winery** trong Launchpad hoặc thư mục `Applications` của macOS.

### Cài đặt Wine dành cho macOS

* Mở ứng dụng **Kegworks Winery** vừa mới cài đặt. Nhấn vào dấu cộng ở góc dưới bên trái (bên trên chữ `Wrapper Version`) để thêm phiên bản Wine mới.

![12](image-11.png)

* Chọn phiên bản Wine mới nhất (thường sẽ ở mục đầu tiên trong danh sách) và nhấn vào nút **Download and Install**.

![13](image-12.png)

* Nhấn OK để bắt đầu tải xuống.

![14](image-13.png)

* Danh sách Installed Engines giờ đây đã có bản Wine bạn mới tải xuống. Tiếp theo là nhấn nút **Update Wrapper**.

![15](image-14.png)

* Nhấn OK để bắt đầu tải xuống.

![16](image-15.png)

* Nhấn vào nút **Create New Blank Wrapper**. Bạn có thể nhập bất kì tên nào bạn muốn, ở đây mình sẽ nhập tên `Nobihaza`.

![17](image-16.png)

* Đợi cho đến khi thông báo tạo thành công như ảnh dưới xuất hiện.

![18](image-17.png)

### Cài đặt thư viện cần thiết cho Wine

Một số game sẽ bị lỗi font/không thể hoạt động đúng được nếu như không cài đặt các thư viện cần thiết.

* Mở Launchpad lên và nhập tên ứng dụng bạn đã nhập ở bước trên.

![19](image-18.png)

* Cửa sổ **KegworksConfig** hiện lên thì bạn nhấn vào nút **Winetricks**. Trước tiên bạn hãy nhập `wmp11` vào thanh tìm kiếm, nhấn vào nút mũi tên bên cạnh trái chữ `dlls` và tích vào mục `wmp11`.

![20](image-19.png)

* Sau đó nhập `allfonts` vào thanh tìm kiếm, nhấn vào nút mũi tên bên cạnh trái chữ `fonts` và tích vào mục `allfonts`.

![21](image-20.png)

* Nhấn vào nút **Run** để bắt đầu cài đặt, sau đó nhấn **Yes** để xác nhận.

![22](image-21.png)

* Đợi cho quá trình cài đặt hoàn tất.

